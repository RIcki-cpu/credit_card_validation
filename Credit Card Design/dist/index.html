<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>CodePen - Virtual Credit Card Design</title>
  <link rel="stylesheet" href="./style.css">

</head>
<body>
<!-- partial:index.partial.html -->
<div class="containerC">
        <div class="card">
            <div class="card-inner">
                <div class="front">
                    <img src="https://i.ibb.co/PYss3yv/map.png" class="map-img">
                    <div class="row">
                        <img src="https://i.ibb.co/G9pDnYJ/chip.png" width="60px">
                        <img src="https://i.ibb.co/WHZ3nRJ/visa.png" width="60px">
                    </div>
                    <div class="row card-no">
                        <p>5244</p>
                        <p>2150</p>
                        <p>8252</p>
                        <p>6420</p>
                    </div>
                    <div class="row card-holder">
                        <p>CARD HOLDER NAME</p>
                        <p>EXPIRES END</p>
                    </div>
                    <div class="row name">
                        <p class ="card-holder-name" >RICHARD MONTALVO</p>
                        <p class ="exp-month">10</p>/<p class="exp-year">25</p>
                    </div>
                </div>
                <div class="back">
                    <img src="https://i.ibb.co/PYss3yv/map.png" class="map-img">
                    <div class="bar"></div>
                    <div class="row card-cvv">
                        <div>
                            <img src="https://i.ibb.co/S6JG8px/pattern.png">
                        </div>
                        <p class="cvv-box">824</p>
                    </div>
                    <div class="row card-text">
                        <p>this is a virtual card design using HTML and CSS.</p>
                    </div>
                    <div class="row signature">
                        <p>CUSTOMER SIGNATURE</p>
                        <img src="https://i.ibb.co/WHZ3nRJ/visa.png" width="80px">
                    </div>
                </div>
            </div>
        </div>
        <div id="space"></div>
        <div class="container" >
            <form id ="form" action="">
                <div class="inputBox">
                    <span>card number</span>
                    <input name="cardnumber" type="text" maxlength="16" class="card-number-input">
                </div>
                <div class="inputBox">
                    <span>card holder</span>
                    <input name="cardholder" type="text" class="card-holder-input">
                </div>
                <div class="flexbox">
                    <div class="inputBox">
                        <span>expiration mm</span>
                        <select name="" id="" class="month-input">
                            <option value="month" selected disabled>month</option>
                            <option value="01">01</option>
                            <option value="02">02</option>
                            <option value="03">03</option>
                            <option value="04">04</option>
                            <option value="05">05</option>
                            <option value="06">06</option>
                            <option value="07">07</option>
                            <option value="08">08</option>
                            <option value="09">09</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                        </select>
                    </div>
                    <div class="inputBox">
                        <span>expiration yy</span>
                        <select name="" id="" class="year-input">
                            <option value="year" selected disabled>year</option>
                            <option value="2021">2021</option>
                            <option value="2022">2022</option>
                            <option value="2023">2023</option>
                            <option value="2024">2024</option>
                            <option value="2025">2025</option>
                            <option value="2026">2026</option>
                            <option value="2027">2027</option>
                            <option value="2028">2028</option>
                            <option value="2029">2029</option>
                            <option value="2030">2030</option>
                        </select>
                    </div>
                    <div class="inputBox">
                        <span>cvv</span>
                        <input type="text" maxlength="4" class="cvv-input">
                    </div>
                </div>
                <input type="submit" value="submit" class="submit-btn">
            </form>
        
              
        </di>
    </div>
<!-- partial -->
  <script>


document.querySelector('.card-number-input').oninput = () =>{
    const textinput = document.querySelector('.card-number-input').value;
    const result = textinput.match(/.{1,4}/g).join(" ");
    
    document.querySelector('.card-no').textContent  = result
}


document.querySelector('.card-holder-input').oninput = () =>{
   // window.alert(document.getElementById('card-holder-name').innerText);
    document.querySelector('.card-holder-name').textContent = document.querySelector('.card-holder-input').value;
}

document.querySelector('.month-input').oninput = () =>{
    document.querySelector('.exp-month').textContent = document.querySelector('.month-input').value;
}

document.querySelector('.year-input').oninput = () =>{
    document.querySelector('.exp-year').textContent = document.querySelector('.year-input').value;
}

document.querySelector('.cvv-input').oninput = () =>{
    document.querySelector('.cvv-box').textContent  = document.querySelector('.cvv-input').value;
}


const form = document.getElementById('form');
form.addEventListener('submit',function(e){
    e.preventDefault();


      // Get the form inputs
    var cardNumber = document.querySelector('.card-number-input').value;
    //var cardHolder = document.querySelector('.card-holder-input').value;
    var expirationMonth = document.querySelector('.month-input').value;
    var expirationYear = document.querySelector('.year-input').value-2000;
    var cvv = document.querySelector('.cvv-input').value;

    const expirationDate = expirationMonth + "/" + expirationYear 

    // Construct the request body
    var requestBody = {
    card_number: cardNumber,
    expiration_date: expirationDate,
    cvv: cvv
  };


  // Send the PUT request
  fetch('http://127.0.0.1:8000/validate_credit_card', {
    method: 'PUT',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(requestBody)
  })
  .then(function(response) {
    // Handle the response from the API
    if (response.ok) {
      console.log (response.json()); // Parse the response body as JSON
    } else {
      throw new Error('Error: ' + response.status);
    }
  })
  .catch(function(error) {
    // Handle any errors that occurred during the request
    alert('An error occurred: ' + error.message);
  });

    //new object FormData Array[Array[2]]
    const payload = new FormData(form)
    console.log([...payload]);
})
  </script>
</body>
</html>
